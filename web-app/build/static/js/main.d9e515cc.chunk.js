(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,a){},14:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(3),o=a.n(c);a(13);const s=()=>{const[e,t]=Object(n.useState)(!1);Object(n.useEffect)(()=>{a()},[]);const a=async()=>{try{const a=await navigator.permissions.query({name:"geolocation"});t("granted"===a.state),a.addEventListener("change",()=>{t("granted"===a.state)})}catch(e){console.error("Error checking permission:",e)}};return{hasPermission:e,requestPermission:()=>{navigator.geolocation.getCurrentPosition(()=>t(!0),()=>t(!1),{enableHighAccuracy:!0})}}};var l=function(){const[e,t]=Object(n.useState)(null),[a,c]=Object(n.useState)(null),[o,l]=Object(n.useState)(""),[i,u]=Object(n.useState)(!1),[d,m]=Object(n.useState)(null),g=Object(n.useRef)(null),b=Object(n.useRef)("web-".concat(Math.random().toString(36).substr(2,9))),{hasPermission:p,requestPermission:y}=s();Object(n.useEffect)(()=>{p&&x()},[p]),Object(n.useEffect)(()=>(E(),()=>{g.current&&g.current.close()}),[]);const E=()=>{g.current=new WebSocket("wss://location-share-ww81.onrender.com"),g.current.onopen=(()=>{u(!0),g.current.send(JSON.stringify({type:"register",userId:b.current}))}),g.current.onclose=(()=>{u(!1),setTimeout(E,3e3)}),g.current.onmessage=(e=>{const t=JSON.parse(e.data);"location"===t.type&&c(t.location)})},x=()=>{navigator.geolocation?navigator.geolocation.watchPosition(e=>{const a={latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy};t(a),g.current&&g.current.readyState===WebSocket.OPEN&&g.current.send(JSON.stringify({type:"location",userId:b.current,location:a}))},e=>{m("Error getting location: ".concat(e.message))},{enableHighAccuracy:!0,maximumAge:0,timeout:5e3}):m("Geolocation is not supported by your browser")};return r.a.createElement("div",{className:"min-h-screen bg-gray-900 text-white p-4"},r.a.createElement("div",{className:"max-w-md mx-auto space-y-4"},p?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"bg-gray-800 p-4 rounded-lg"},r.a.createElement("h2",{className:"text-lg font-semibold mb-2"},"Status"),r.a.createElement("p",{className:"text-sm"},"Connection: ",i?r.a.createElement("span",{className:"text-green-500"},"Connected"):r.a.createElement("span",{className:"text-red-500"},"Disconnected")),e&&r.a.createElement("p",{className:"text-sm"},"Your location: ",e.latitude.toFixed(6),", ",e.longitude.toFixed(6)),a&&r.a.createElement("p",{className:"text-sm"},"Partner location: ",a.latitude.toFixed(6),", ",a.longitude.toFixed(6))),r.a.createElement("div",{className:"flex gap-2"},r.a.createElement("input",{type:"text",value:o,onChange:e=>l(e.target.value),className:"flex-1 bg-gray-800 text-white px-4 py-2 rounded-lg",placeholder:"Type emergency message..."}),r.a.createElement("button",{onClick:()=>{var e;o.trim()&&(null===(e=g.current)||void 0===e?void 0:e.readyState)===WebSocket.OPEN&&(g.current.send(JSON.stringify({type:"message",userId:b.current,text:o})),l(""))},className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg"},"Send"))):r.a.createElement("button",{onClick:y,className:"w-full bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg"},"Enable Location Sharing"),d&&r.a.createElement("div",{className:"bg-red-900/50 border border-red-500 p-4 rounded-lg"},d)))};o.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(l,null)))},4:function(e,t,a){e.exports=a(14)}},[[4,1,2]]]);
//# sourceMappingURL=main.d9e515cc.chunk.js.map